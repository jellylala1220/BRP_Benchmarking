# T0ï¼ˆè‡ªç”±æµæ—¶é—´ï¼‰è®¡ç®—æŒ‡å—

## ğŸ“Š æ ¸å¿ƒåŸåˆ™

**T0åº”è¯¥ä»fused_tt_15minä¸­å–æœ€ä½ç™¾åˆ†ä½ï¼Œè€Œä¸æ˜¯ä»é€Ÿåº¦è®¡ç®—**

### ä¸ºä»€ä¹ˆï¼Ÿ

1. **çœŸå®åæ˜ **ï¼šfused_tt_15minæ¥è‡ªå®é™…æµ‹é‡çš„Fused Travel Timeï¼Œåæ˜ çœŸå®è½¦è¾†é€šè¿‡è·¯æ®µçš„ç”¨æ—¶
2. **é¿å…åå·®**ï¼šä»é€Ÿåº¦è®¡ç®—ä¼šå—è½¦é“é€Ÿåº¦ä¸å‡ã€ä¼ æ„Ÿå™¨å™ªå£°ç­‰å› ç´ å½±å“ï¼Œå¯¼è‡´é«˜ä¼°
3. **ç¬¦åˆå®šä¹‰**ï¼šT0æ˜¯"äº¤é€šå®Œå…¨ç•…é€šæ—¶çš„ç†è®ºæ—…è¡Œæ—¶é—´"ï¼Œåº”è¯¥ç”¨å®é™…è§‚æµ‹çš„æœ€ä½å€¼

---

## ğŸ”„ æ•°æ®æµç¨‹

### æ­¥éª¤1ï¼šè·å–Ground Truthï¼ˆfused_tt_15minï¼‰

**ä¼˜å…ˆçº§1ï¼šä»CSVæ–‡ä»¶è¯»å–ï¼ˆæ¨èï¼‰**

```python
# CSVæ–‡ä»¶åŒ…å«ç§’çº§çš„"Fused Travel Time"
# ä¾‹å¦‚ï¼š2024-09-01 00:14:42 â†’ 105.13ç§’

# èšåˆåˆ°15åˆ†é’Ÿçª—å£
df_csv['datetime_15min'] = df_csv['datetime_csv'].dt.floor('15min')
fused_tt_15min = df_csv.groupby('datetime_15min')['Fused Travel Time'].mean()
```

**ä¼˜å…ˆçº§2ï¼šä»é€Ÿåº¦è®¡ç®—ï¼ˆå›é€€æ–¹æ¡ˆï¼‰**

```python
# å¦‚æœCSVä¸å¯ç”¨ï¼Œä»é€Ÿåº¦å’Œé•¿åº¦è®¡ç®—
fused_tt_15min = (link_length_km / v_avg_kmh) * 3600
```

### æ­¥éª¤2ï¼šè®¡ç®—T0ï¼ˆè‡ªç”±æµæ—¶é—´ï¼‰

**æ–¹æ³•ï¼šä»fused_tt_15minä¸­å–æœ€ä½ç™¾åˆ†ä½**

```python
# ç­–ç•¥1ï¼šæœ€ä½5%å‡å€¼ï¼ˆé»˜è®¤ï¼Œæ¨èï¼‰
t0_candidates = df['fused_tt_15min'].nsmallest(int(len(df) * 0.05))
t0_ff = t0_candidates.mean()

# ç­–ç•¥2ï¼šæœ€ä½10%å‡å€¼
t0_candidates = df['fused_tt_15min'].nsmallest(int(len(df) * 0.10))
t0_ff = t0_candidates.mean()

# ç­–ç•¥3ï¼šä½æµé‡æ—¶çš„ä¸­ä½æ•°
low_vol_mask = df['flow_veh_hr'] < 500
t0_ff = df.loc[low_vol_mask, 'fused_tt_15min'].median()
```

---

## ğŸ“ˆ å®é™…æ¡ˆä¾‹

### è·¯æ®µ115030402

**æ•°æ®æ¥æº**ï¼š
- CSVæ–‡ä»¶ï¼š`M67 westbound between J4 and J3 mainCarriageway 115030402.csv`
- ç¬¬ä¸€æ®µï¼ˆ2024-09-01 00:00-00:14:59ï¼‰ï¼šFused Travel Time â‰ˆ 105.13ç§’

**è®¡ç®—è¿‡ç¨‹**ï¼š
1. è¯»å–CSVä¸­çš„Fused Travel Time
2. èšåˆåˆ°15åˆ†é’Ÿçª—å£ï¼ˆæ¯ä¸ªçª—å£å–å¹³å‡å€¼ï¼‰
3. å–æœ€ä½5%çš„fused_tt_15minå‡å€¼
4. ç»“æœï¼šT0 â‰ˆ 105-110ç§’

**é”™è¯¯æ–¹æ³•ï¼ˆå·²ä¿®å¤ï¼‰**ï¼š
- âŒ ä»åŠ æƒå¹³å‡é€Ÿåº¦è®¡ç®—ï¼š`T = (L / v_weighted) * 3600`
- âŒ ç»“æœï¼šT0 â‰ˆ 173ç§’ï¼ˆå—è½¦é“é€Ÿåº¦å½±å“ï¼Œé«˜ä¼°ï¼‰

---

## âš™ï¸ é…ç½®é€‰é¡¹

åœ¨ `build_finaldata()` ä¸­ï¼š

```python
df = build_finaldata(
    link_id=115030402,
    precleaned_path="...",
    snapshot_csv_path="...",  # æä¾›CSVè·¯å¾„ä»¥ä½¿ç”¨çœŸå®Fused Travel Time
    t0_strategy="min5pct",     # T0è®¡ç®—ç­–ç•¥
    ...
)
```

**t0_strategyé€‰é¡¹**ï¼š
- `"min5pct"`: ä½¿ç”¨æœ€ä½5%çš„fused_tt_15minå‡å€¼ï¼ˆæ¨èï¼‰
- `"min10pct"`: ä½¿ç”¨æœ€ä½10%çš„fused_tt_15minå‡å€¼
- `"low_volume"`: ä½¿ç”¨ä½æµé‡(<500 veh/hr)æ—¶çš„fused_tt_15minä¸­ä½æ•°

---

## âœ… éªŒè¯æ–¹æ³•

### æ£€æŸ¥T0åˆç†æ€§

```python
# T0åº”è¯¥æ¥è¿‘æœ€ä½çš„fused_tt_15minå€¼
print(f"T0: {t0_ff:.2f} ç§’")
print(f"æœ€ä½5%èŒƒå›´: [{df['fused_tt_15min'].quantile(0.05):.2f}, {df['fused_tt_15min'].quantile(0.10):.2f}] ç§’")
print(f"æœ€ä½å€¼: {df['fused_tt_15min'].min():.2f} ç§’")

# T0åº”è¯¥å°äºç†è®ºæœ€å°å€¼ï¼ˆå‡è®¾æœ€å¤§é€Ÿåº¦120 km/hï¼‰
theoretical_min = (link_length_km / 120) * 3600
assert t0_ff >= theoretical_min, "T0å°äºç†è®ºæœ€å°å€¼"
```

### é¢„æœŸç»“æœ

å¯¹äºè·¯æ®µ115030402ï¼ˆé•¿åº¦2713.8mï¼‰ï¼š
- **æ­£ç¡®çš„T0**ï¼š105-110ç§’ï¼ˆä»CSVçš„Fused Travel Timeè®¡ç®—ï¼‰
- **é”™è¯¯çš„T0**ï¼š173ç§’ï¼ˆä»åŠ æƒé€Ÿåº¦è®¡ç®—ï¼Œå·²ä¿®å¤ï¼‰

---

## ğŸ¯ æ€»ç»“

1. âœ… **ä¼˜å…ˆä½¿ç”¨CSVä¸­çš„Fused Travel Time**ä½œä¸ºground truth
2. âœ… **èšåˆåˆ°15åˆ†é’Ÿçª—å£**ï¼šå°†ç§’çº§æ•°æ®æŒ‰15åˆ†é’Ÿåˆ†ç»„å–å¹³å‡
3. âœ… **ä»fused_tt_15minè®¡ç®—T0**ï¼šå–æœ€ä½5%æˆ–10%çš„å‡å€¼
4. âŒ **é¿å…ä»é€Ÿåº¦è®¡ç®—T0**ï¼šä¼šå—è½¦é“é€Ÿåº¦å½±å“å¯¼è‡´åå·®

---

**æ›´æ–°æ—¥æœŸ**: 2024-11-12  
**çŠ¶æ€**: âœ… å·²ä¿®å¤

